<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    <bean id="props" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="/WEB-INF/cloud.properties"/>
    </bean>

    <bean id="ds" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName" value="java:comp/env/jdbc/cng"/>
    </bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="ds"/>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.show_sql">${hibernate.showSQL}</prop>
                <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
            </props>
        </property>
        <property name="annotatedClasses">
            <list>
                <value>com.cng.cloud.data.Host</value>
            </list>
        </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <bean id="beanFactory" class="org.dreamwork.persistence.ServiceFactory"/>

    <bean id="baseService"
          class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean"
          abstract="true" lazy-init="true">
        <property name="transactionManager" ref="transactionManager"/>
        <property name="transactionAttributes">
            <props>
                <prop key="*">PROPAGATION_REQUIRED,-Exception</prop>
            </props>
        </property>
    </bean>

    <!-- generic type magic -->
    <bean id="abstractDaoTarget" abstract="true"
          class="org.dreamwork.persistence.hibernate.dao.impl.GenericHibernateDaoImpl">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>
    <bean id="abstractServiceTarget" abstract="true" class="org.dreamwork.persistence.GenericServiceSpringImpl"/>
    <bean id="genericDao" class="org.springframework.aop.framework.ProxyFactoryBean" abstract="true"/>
    <bean id="genericService" class="org.springframework.aop.framework.ProxyFactoryBean" abstract="true"/>

    <bean id="hostService" parent="baseService">
        <property name="target">
            <bean class="com.cng.cloud.service.impls.HostServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.cng.cloud.data.Host"/>
                            </bean>
                        </property>
                    </bean>
                </property>
            </bean>
        </property>
    </bean>

<!--
    <bean id="commonService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.CommonService">
            	<property name="consoleIp" value="${console.webservice.ip}" />
                <property name="dao" ref="commonDao" />
                <property name="jdbcDao" ref="commonJdbcDao" />
                <property name="hibernateDao" ref="hibernateDao" />
            </bean>
        </property>
    </bean>
    
    <bean id="hibernateDao" class="com.salon.dao.CommonHibernateDao">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <bean id="commonDao" class="com.salon.dao.CommonDao">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>


	<bean id="commonJdbcDao" class="com.salon.dao.CommonJdbcDao">
        <property name="dataSource">
            <ref bean="ds" />
        </property>
    </bean>
    
    <bean id="regionService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.RegionService">
                <property name="dao" ref="commonDao" />
            </bean>
        </property>
    </bean>

    <bean id="storeService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Store" />
                            </bean>
                        </property>
                    </bean>
                </property>
								<property name="employeeDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.Employee"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="imageStoreMemoDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.image.ImageStoreMemo"/>
														</bean>
												</property>
										</bean>
								</property>
								
								<property name="jdbcDao" ref="commonJdbcDao" />
            </bean>
        </property>
    </bean>

    <bean id="designerService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.DesignerServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Designer" />
                            </bean>
                        </property>
                    </bean>
                </property>
								<property name="imageDesignerDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.image.ImageDesigner"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="categoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Category"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="commonDao" ref="commonDao" />
            </bean>
        </property>
    </bean>

    <bean id="employeeService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.EmployeeServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Employee" />
                            </bean>
                        </property>
                    </bean>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="cardService" parent="baseService">
        <property name="target">
            <bean class="com.salon.backend.service.impl.CardServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Card" />
                            </bean>
                        </property>
                    </bean>
                </property>
								<property name="storeDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.Store"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="storeLicenseHistoryDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.StoreLicenseHistory"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="pointHistoryDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.PointHistory"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
    
    &lt;!&ndash; 许可证 &ndash;&gt;
    <bean id="storeLicenseService" parent="baseService">
        <property name="target">
            <bean class="com.salon.backend.service.impl.StoreLicenseServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreLicense" />
                            </bean>
                        </property>
                    </bean>
                </property>
								<property name="storeLicenseHistoryDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.StoreLicenseHistory"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
    
    <bean id="itemService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.ItemServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Item" />
                            </bean>
                        </property>
                    </bean>
                </property>
                <property name="commonDao" ref="commonDao" />
                <property name="hibernateDao" ref="hibernateDao" />
            </bean>
        </property>
    </bean>

    <bean id="categoryService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.CategoryServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Category" />
                            </bean>
                        </property>
                    </bean>
                </property>
								<property name="storeCategoryDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.StoreCategory"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="imageStoreCategoryDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.image.ImageStoreCategory"/>
														</bean>
												</property>
										</bean>
								</property>
								
								<property name="jdbcDao" ref="commonJdbcDao" />
            </bean>
        </property>
    </bean>
        
    <bean id="storeLicenseHistoryService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreLicenseHistoryServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreLicenseHistory"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
            
    <bean id="storeNoticeService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreNoticeServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreNotice"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="imageStoreNoticeDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.image.ImageStoreNotice"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
    
    <bean id="brandService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.BrandServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Brands"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
                
    <bean id="storeHairPriceService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreHairPriceServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreHairPrice"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="memoDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreHairMemo"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
                    
    &lt;!&ndash;<bean id="storeHairPictureService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreHairPictureServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreHairPicture"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="pictureCategoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreHairPictureCategory"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="categoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Category"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="commonDao" ref="commonDao" />
            </bean>
        </property>
    </bean>&ndash;&gt;
                        
		&lt;!&ndash; 创意图库 &ndash;&gt;
    <bean id="storePictureService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StorePictureServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePicture"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="pictureCategoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePictureCategory"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="pictureDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Picture"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="categoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Category"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="commonDao" ref="commonDao" />
            </bean>
        </property>
    </bean>
                        
    <bean id="dispatchService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.DispatchServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Store"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="storePictureDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePicture"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="categoryDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Category"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="designerDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Designer"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="storeHairPriceDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreHairPrice"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="storeVipCardDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreVipCard"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="storePriceDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePrice"/>
														</bean>
												</property>
										</bean>
								</property>
                &lt;!&ndash;<property name="templateActivityDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.TemplateActivity"/>
														</bean>
												</property>
										</bean>
								</property>&ndash;&gt;
            		<property name="commonDao" ref="commonDao" />
            </bean>
        </property>
    </bean>
                        
    <bean id="templateService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.TemplateServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Template"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>

    &lt;!&ndash; VIP会员卡 &ndash;&gt;
    <bean id="storeVipCardService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StoreVipCardServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StoreVipCard"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
    
    &lt;!&ndash; start log appender &ndash;&gt;
    <bean id="AsynchronousAppender" class="com.salon.backend.log.appender.AsynchronousAppender" init-method="initialize" destroy-method="shutdown">
        <property name="commonDao" ref="commonDao" />
        <property name="transactionTemplate" ref="tt" />
        <property name="loggingEventClass" value="com.salon.backend.log.bean.Log"/>
    </bean>
    <bean id="tt" class="org.springframework.transaction.support.TransactionTemplate"> 
      <property name="transactionManager"> 
        <ref bean="transactionManager"/> 
      </property> 
    </bean> 
    &lt;!&ndash; end log appender &ndash;&gt;

    <bean id="apkService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.ApkServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.ApkVersion" />
                            </bean>
                        </property>
                    </bean>
                </property>
            </bean>
        </property>
    </bean>
    
		&lt;!&ndash; 门店价目表 &ndash;&gt;
    <bean id="storePriceService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.StorePriceServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePrice"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="priceDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePriceSerial"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="memoDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.StorePriceMemo"/>
														</bean>
												</property>
										</bean>
								</property>
								<property name="imageStorePriceDao">
										<bean parent="genericDao">
												<property name="target">
														<bean parent="abstractDaoTarget">
																<constructor-arg value="com.salon.data.image.ImageStorePrice"/>
														</bean>
												</property>
										</bean>
								</property>
            		<property name="commonDao" ref="commonDao" />
            </bean>
        </property>
    </bean>
        
		&lt;!&ndash; 角色管理 &ndash;&gt;
    <bean id="roleService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.RoleServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.SysRole"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="menuRoleDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.SysMenuRole"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="employeeDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.Employee"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="employeeRoleDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.SysEmployeeRole"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
        
		&lt;!&ndash; 菜单 &ndash;&gt;
    <bean id="menuService" parent="baseService">
        <property name="target">
            <bean class="com.salon.core.service.impl.MenuServiceImpl">
                <property name="dao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.SysMenu"/>
														</bean>
												</property>
										</bean>
								</property>
                <property name="menuRoleDao">
                    <bean parent="genericDao">
                        <property name="target">
                            <bean parent="abstractDaoTarget">
                                <constructor-arg value="com.salon.data.SysMenuRole"/>
														</bean>
												</property>
										</bean>
								</property>
            </bean>
        </property>
    </bean>
-->

</beans>